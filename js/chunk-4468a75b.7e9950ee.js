(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4468a75b"],{3519:function(t,e,s){"use strict";s.r(e);var a,i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-100 row"},[s("NavBar",{staticClass:"col-md-2",on:{"after-show-tweet-modal":t.afterShowTweetModal}}),s("div",{staticClass:"col-md-10 d-flex h-100"},[s("div",{staticClass:"chatroom-users "},[s("ChatroomUserCards",{attrs:{users:t.users}})],1),s("div",{staticClass:"chatroom-content"},[s("h5",{staticClass:"chatroom-content-title p-3"},[t._v("公開聊天室")]),s("div",{staticClass:"chatroom-container"},[s("div",{staticClass:"display-container"},[t._l(t.messages,(function(e){return s("div",{key:e.index,class:{notification:1===e.typeId,"card-other":2===e.typeId,"card-self":3===e.typeId}},[1===e.typeId?s("span",[t._v(t._s(e.content))]):t._e(),2===e.typeId?s("div",{staticClass:"card-other-container"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:t._f("emptyImage")(e.avatar),alt:"avatar"}})]),s("div",{staticClass:"content-container"},[s("div",{staticClass:"text"},[t._v(" "+t._s(e.content)+" ")]),s("p",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.time)))])])]):t._e(),3===e.typeId?s("div",{staticClass:"card-self-container"},[s("div",{staticClass:"text"},[t._v(" "+t._s(e.content)+" ")]),s("p",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.time)))])]):t._e()])})),t.previousMessages.length>0?t._l(t.previousMessages,(function(e){return s("div",{key:e.index,class:{notification:1===e.typeId,"card-other":2===e.typeId,"card-self":3===e.typeId}},[1===e.typeId?s("span",[t._v(t._s(e.content))]):t._e(),2===e.typeId?s("div",{staticClass:"card-other-container"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:t._f("emptyImage")(e.avatar),alt:"avatar"}})]),s("div",{staticClass:"content-container"},[s("div",{staticClass:"text"},[t._v(" "+t._s(e.content)+" ")]),s("p",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.time)))])])]):t._e(),3===e.typeId?s("div",{staticClass:"card-self-container"},[s("div",{staticClass:"text"},[t._v(" "+t._s(e.content)+" ")]),s("p",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.time)))])]):t._e()])})):t._e()],2),s("div",{staticClass:"input-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputMessage,expression:"inputMessage"}],attrs:{type:"text",placeholder:"輸入訊息..."},domProps:{value:t.inputMessage},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)},input:function(e){e.target.composing||(t.inputMessage=e.target.value)}}}),s("button",{on:{click:t.sendMessage}},[s("img",{attrs:{src:"https://i.imgur.com/Jrjlukd.jpg",alt:""}})])])])])]),t.showModal?s("TweetModal",{on:{"after-hide-modal":t.afterHideModal}}):t._e()],1)},n=[],c=s("ade3"),r=s("5530"),o=s("d000"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatroom-container"},[s("p",{staticClass:"chatroom-title"},[t._v("上線 ("+t._s(t.users.length)+")")]),s("div",{staticClass:"chatroom-cards"},t._l(t.users,(function(e){return s("div",{key:e.UserId,staticClass:"chatroom-card d-flex justify-content-start align-items-center"},[s("img",{staticClass:"chatroom-card-img",attrs:{src:t._f("emptyImage")(e.avatar)}}),s("p",{staticClass:"chatroom-card-name"},[t._v(t._s(e.name))]),s("p",{staticClass:"chatroom-card-account"},[t._v("＠"+t._s(e.account))])])})),0)])},l=[],u=s("2708"),m={name:"ChatroomCards",mixins:[u["a"]],props:{users:{type:Array,required:!0}}},f=m,p=(s("efb7"),s("2877")),v=Object(p["a"])(f,d,l,!1,null,"58497795",null),h=v.exports,g=s("4287"),_=s("2f62"),y={name:"Chatroom",components:{NavBar:o["a"],TweetModal:g["a"],ChatroomUserCards:h},data:function(){return{showModal:!1,messages:[],inputMessage:"",users:[],previousMessages:[]}},computed:Object(r["a"])({},Object(_["b"])(["currentUser"])),mixins:[u["a"],u["b"]],methods:{afterShowTweetModal:function(){this.showModal=!0},afterHideModal:function(){this.showModal=!1},sendMessage:function(){this.inputMessage&&(this.$socket.client.emit("public message",this.inputMessage),this.inputMessage="")},connectUser:function(){this.$socket.client.emit("enter chatroom")},disconnectUser:function(){this.$socket.client.emit("leave chatroom")}},sockets:(a={},Object(c["a"])(a,"render public messages",(function(t){for(var e=0;e<t.length;e++){var s=t[e];if(s.senderId===this.currentUser.id){var a={id:-1,content:s.message,typeId:3,type:"self",time:s.createdAt,avatar:""};this.previousMessages.unshift(a)}else{var i={id:-1,content:s.message,typeId:2,type:"other",time:s.createdAt,avatar:s.Receiver.avatar};this.previousMessages.unshift(i)}}})),Object(c["a"])(a,"users",(function(t){this.users=t})),Object(c["a"])(a,"public message",(function(t){if(t.senderId===this.currentUser.id){var e={id:-1,content:t.message,typeId:3,type:"self",time:t.createdAt,avatar:""};this.messages.unshift(e)}else{var s={id:-1,content:t.message,typeId:2,type:"other",time:t.createdAt,avatar:t.senderAvatar};this.messages.unshift(s)}})),Object(c["a"])(a,"user connect",(function(t){var e={id:-1,content:t,typeId:1,type:"notification",time:"",avatar:""};this.messages.unshift(e)})),Object(c["a"])(a,"user disconnect",(function(t){var e={id:-1,content:t,typeId:1,type:"notification",time:"",avatar:""};this.messages.unshift(e)})),a),created:function(){this.connectUser()},beforeDestroy:function(){this.disconnectUser(),this.$socket.client.off("render public messages"),this.$socket.client.off("users"),this.$socket.client.off("public message"),this.$socket.client.off("user connect"),this.$socket.client.off("user disconnect")}},C=y,b=(s("6607"),Object(p["a"])(C,i,n,!1,null,"b2969b4a",null));e["default"]=b.exports},"59c6":function(t,e,s){},6607:function(t,e,s){"use strict";s("59c6")},b0dc:function(t,e,s){},efb7:function(t,e,s){"use strict";s("b0dc")}}]);
//# sourceMappingURL=chunk-4468a75b.7e9950ee.js.map